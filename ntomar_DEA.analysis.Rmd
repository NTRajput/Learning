---
title: "Data Envelopment Analysis"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

####DEA analysis HW 
This file contains :
+solutions of DEA analysis performed under different assumptions of FDH, CRS, VRS, IRS, DRS,  and FRH.
+ Peers and Lambdas under each of the above assumptions
+ frontier function PLOT for each part 
+ result summary in a tabular form 

###Given problem :
The Hope Valley Health Care Association owns and operates six nursing homes in adjoining states.
we have an An evaluation of their efficiency on basis of inputs are
+staffing labor (measured in average hours per day) 
+ cost of supplies (in thousands of dollars per day)
The outputs are:
+the number of patient-days reimbursed by third-party sources
+number of patient-days reimbursed privately 
+the summary of performance data can be seen by the Print Below :
```{r}
library(lpSolveAPI)
x <- matrix(c(150,400,320,520,350,320,0.2,0.7,1.2,2,1.2,0.7),ncol = 2)
y <- matrix(c(14000,14000,42000,28000,19000,14000,3500,21000,10500,42000,25000,15000), ncol=2)
print(cbind(x,y))
```

###Solution:

####1.constant return to scale model-CRS
  + (Assumption k>=0 , Λk>=0)
```{r}
library(lpSolveAPI)
library(ucminf)
library(Benchmarking)
x <- matrix(c(150,400,320,520,350,320,0.2,0.7,1.2,2,1.2,0.7),ncol = 2)
y <- matrix(c(14000,14000,42000,28000,19000,14000,3500,21000,10500,42000,25000,15000), ncol=2)
e <- dea(x,y,RTS = "crs")
e
peers(e)
lambda(e)
rowSums(x)
rowSums(y)
dea.plot( rowSums(x),rowSums(y),RTS="crs")
tt <- as.data.frame(matrix(c(x,y),ncol=4))
tt
library(ggplot2)
ggplot(data=tt,aes(V2,V3)) +
  geom_line(aes(color="Red")) +
  geom_line(aes(V2,V4),color="yellow",show.legend = T)
```
  
  
  **Results**: in the above model, when we analyse the result we can find that Facility 1-4 are efficient as the sum of L1,L2 , L3 and L4 s exactly one.
Facility 5-6 are inefficient. Facility 5-6 could be updated by closer to other facilities.Facility 5 should use (0.2) Xfacility1,(0.08048142)Xfacility 2, (0.5383307)Xfacility4. and for facility 6 (0.3428571)Xfacility1, (0.39499264)Xfacility2, and (0.1310751)Xfacility4.  
 
 
####2.Varing return to scale model- VRS
  + (Assumption k=1 , ∑Λk=1)
```{r}
library(lpSolveAPI)
library(ucminf)
library(Benchmarking)
x <- matrix(c(150,400,320,520,350,320,.2,.7,1.2,2,1.2,.7),ncol = 2)
y <- matrix(c(14000,14000,42000,28000,19000,14000,3500,21000,10500,42000,25000,15000), ncol=2)
e <- dea(x,y,RTS = "vrs")
e
peers(e)
lambda(e)
rowSums(x)
rowSums(y)
dea.plot( rowSums(x),rowSums(y),RTS="vrs",wx=0.01,wy=0.01)
```
  
  
   **Results**:only facility 6 is inefficient. It could be updated by using (0.4014399)Xfacility1, (0.3422606)Xfacility2, (0.2562995)Xfacility5.
 


####3.Increasing return to scale model - IRS
  + (assumptions K>=1 ,∑Λk>=1)
```{r}
library(lpSolveAPI)
library(ucminf)
library(Benchmarking)
x <- matrix(c(150,400,320,520,350,320,.2,.7,1.2,2,1.2,.7),ncol = 2)
y <- matrix(c(14000,14000,42000,28000,19000,14000,3500,21000,10500,42000,25000,15000), ncol=2)
e <- dea(x,y,RTS = "irs")
e
peers(e)
lambda(e)
rowSums(x)
rowSums(y)
dea.plot( rowSums(x),rowSums(y),RTS="irs",wx=0.01,wy=0.01)
```

  
  **Results** only facility 6 is inefficient. It could be updated by (0.4014399)Xfacility1, (0.3422606)Xfacility2, and (0.2562995X)facility 5.
 
 
####3.Decreasing return to scale model - DRS
   + (assumptions K<=1 ,∑Λk<=1)
```{r}
library(lpSolveAPI)
library(ucminf)
library(Benchmarking)
x <- matrix(c(150,400,320,520,350,320,.2,.7,1.2,2,1.2,.7),ncol = 2)
y <- matrix(c(14000,14000,42000,28000,19000,14000,3500,21000,10500,42000,25000,15000), ncol=2)
e <- dea(x,y,RTS = "drs")
e
peers(e)
lambda(e)
rowSums(x)
rowSums(y)
dea.plot( rowSums(x),rowSums(y),RTS="drs",wx=0.01,wy=0.01)
```
   
   
  **Results** both facility 5 and 6 are inefficient. Facility 5 could be updated by approaching vlaues near to facility (0.2000)xFaciluty1,(0.08048124)xfacility2,(0.5383307)xfacility4Facility 6 could be updated by using lamba vlaue 1,2,4 - (0.3428571)xfacility1 , (0.39499264)xfacility2 , (0.1310751)x facility3  


####4.The free disposability hull model- FDH
  +(Assumptions k=1 ,∑Λk=1 εΛK = {0,1})
```{r}
library(lpSolveAPI)
library(ucminf)
library(Benchmarking)
x <- matrix(c(150,400,320,520,350,320,.2,.7,1.2,2,1.2,.7),ncol = 2)
y <- matrix(c(14000,14000,42000,28000,19000,14000,3500,21000,10500,42000,25000,15000), ncol=2)
e <- dea(x,y,RTS = "fdh", ORIENTATION = 2)
e
peers(e)
lambda(e)
rowSums(x)
rowSums(y)
dea.plot( rowSums(x),rowSums(y),RTS="fdh",wx=0.01,wy=0.01)
```
  
  
  **Results** All facilities are efficient under this model.
  
####5.Free replicability hull models -FRH
  +(Assumptions K=1, ε Λ^k =N0 AND use code add)
```{r}
library(lpSolveAPI)
library(ucminf)
library(Benchmarking)
x <- matrix(c(150,400,320,520,350,320,.2,.7,1.2,2,1.2,.7),ncol = 2)
y <- matrix(c(14000,14000,42000,28000,19000,14000,3500,21000,10500,42000,25000,15000), ncol=2)
e <- dea(x,y,RTS = "add")
e
peers(e)
lambda(e)
rowSums(x)
rowSums(y)
dea.plot( rowSums(x),rowSums(y),RTS="add",wx=0.01,wy=0.01)
```
  
  
  **Results**all facilities are efficient.


###Conclusion :
we have different models and varying the result for facilities efficiences .
In order to use this analysis for our problem , we can see by employing which model we can achieve efficeincy in all models.
